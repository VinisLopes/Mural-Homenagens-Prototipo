<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mural de Homenagens – Exibição na TV</title>
<meta name="description" content="Tela de exibição do mural de homenagens para uso em TVs nas salas de velório.">

<script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>

<style>
:root{
  --bg:#020617;
  --surface:#020617;
  --primary:#38bdf8;
  --accent:#22c55e;
  --text:#e5e7eb;
  --muted:#9ca3af;
  --shadow:0 30px 80px rgba(0,0,0,.85);
  --radius:28px;
}

*,
*::before,
*::after{
  box-sizing:border-box;
  margin:0;
  padding:0;
}
html,body{
  height:100%;
}
body{
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:
    radial-gradient(circle at 0 0,#0f172a,transparent 55%),
    radial-gradient(circle at 100% 100%,#082f49,transparent 55%),
    #020617;
  color:var(--text);
}

/* LAYOUT GERAL – MODO TV */
.tv-wrapper{
  min-height:100vh;
  padding:2.6rem 3.2rem;
  display:flex;
  align-items:center;
  justify-content:center;
}
.tv-frame{
  width:100%;
  max-width:1240px;
  min-height:560px;
  border-radius:var(--radius);
  background:
    radial-gradient(circle at 0 0,rgba(56,189,248,.22),transparent 60%),
    radial-gradient(circle at 100% 100%,rgba(34,197,94,.18),transparent 55%),
    #020617;
  box-shadow:var(--shadow);
  padding:2rem 2.4rem 2.2rem;
  position:relative;
  overflow:hidden;
}

/* TOPO */
.tv-header{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  margin-bottom:1.7rem;
}
.tv-title-block{
  max-width:62%;
}
.tv-label{
  font-size:.9rem;
  text-transform:uppercase;
  letter-spacing:.18em;
  color:var(--muted);
  margin-bottom:.45rem;
}
.tv-name{
  font-size:1.9rem;
  font-weight:700;
}
.tv-years{
  font-size:1rem;
  color:var(--muted);
  margin-top:.25rem;
}
.tv-quote{
  margin-top:.6rem;
  font-size:1rem;
  color:#e5e7eb;
}
.tv-badge{
  font-size:.78rem;
  padding:.4rem .9rem;
  border-radius:999px;
  border:1px solid rgba(148,163,184,.6);
  background:rgba(15,23,42,.85);
}

/* MAIN = MURAL + GRUPOS */
.tv-main{
  display:flex;
  flex-direction:column;
  gap:1.6rem;
}

/* CARROSSEL PRINCIPAL */
.tv-carousel{
  border-radius:24px;
  border:1px solid rgba(148,163,184,.55);
  background:rgba(15,23,42,.94);
  padding:1.3rem 1.5rem 1.6rem;
  backdrop-filter:blur(18px);
  position:relative;
  overflow:hidden;
}
.tv-carousel-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:.9rem;
}
.tv-carousel-type{
  font-size:.92rem;
  font-weight:500;
}
.tv-carousel-counter{
  font-size:.82rem;
  color:var(--muted);
}

/* ÁREA DE MÍDIA (ONDE FICA A FOTO/VIDEO + SETAS) */
.tv-media-wrapper{
  position:relative;
  margin-bottom:1.2rem;
}
.tv-slide{
  display:none;
  animation:.45s ease-out fadeInUp;
}
.tv-slide.active{
  display:block;
}

@keyframes fadeInUp{
  from{opacity:0;transform:translateY(10px);}
  to{opacity:1;transform:translateY(0);}
}

/* SLIDE COM FOTO / VÍDEO */
.tv-slide-media{
  border-radius:20px;
  background:#000000;
  overflow:hidden;
  min-height:260px;
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
}
.tv-slide-photo img{
  width:100%;
  max-height:320px;
  object-fit:contain;
  background:#000;
}
.tv-video{
  width:100%;
  max-height:320px;
  display:block;
  background:#000;
}

/* SLIDE APENAS TEXTO – card se ajusta ao tamanho do texto */
.tv-slide-texto .tv-slide-media{
  display:none;
}
.tv-slide-texto .tv-slide-body{
  padding:2.4rem 3rem 1.8rem;
}

/* TEXTO DO SLIDE */
.tv-slide-body{
  padding:1.1rem 1.4rem 0;
}
.tv-slide-text{
  font-size:1.02rem;
  line-height:1.5;
  color:#e5e7eb;
  margin-bottom:.9rem;
  text-align:center;
}
.tv-slide-meta{
  font-size:.85rem;
  color:var(--muted);
  text-align:center;
}

/* SETAS DENTRO DA ÁREA DE MÍDIA */
.tv-arrow{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  width:34px;
  height:34px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,.85);
  background:rgba(15,23,42,.88);
  color:#e5e7eb;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:1.15rem;
  cursor:pointer;
  box-shadow:0 12px 30px rgba(15,23,42,.65);
}
.tv-arrow-left{left:16px;}
.tv-arrow-right{right:16px;}
.tv-arrow:disabled{
  opacity:.4;
  cursor:default;
}

/* CONTROLES (BOLINHAS) */
.tv-controls{
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:.8rem;
  color:var(--muted);
}
.tv-dots{
  display:flex;
  gap:.3rem;
  align-items:center;
}
.tv-dot{
  width:8px;
  height:8px;
  border-radius:999px;
  background:rgba(148,163,184,.5);
  opacity:.5;
  transition:all .2s ease;
}
.tv-dot.active{
  width:16px;
  opacity:1;
  background:var(--primary);
}

/* GRUPOS DE ITENS (FOTOS / VÍDEOS / TEXTOS) */
.tv-groups{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:1.1rem;
}
.tv-group-card{
  border-radius:20px;
  border:1px solid rgba(148,163,184,.45);
  background:linear-gradient(145deg,rgba(15,23,42,.96),rgba(15,23,42,.9));
  padding:1.05rem 1.15rem 1rem;
  backdrop-filter:blur(16px);
}
.tv-group-header{
  display:flex;
  justify-content:space-between;
  align-items:baseline;
  margin-bottom:.2rem;
}
.tv-group-title{
  font-size:.95rem;
}
.tv-group-count{
  font-size:.75rem;
  color:var(--muted);
}
.tv-group-sub{
  font-size:.78rem;
  color:var(--muted);
  margin-bottom:.7rem;
}

/* LISTA DE ITENS DENTRO DOS GRUPOS */
.tv-items{
  display:flex;
  flex-direction:column;
  gap:.45rem;
}
.tv-item{
  border-radius:14px;
  padding:.55rem .75rem;
  display:flex;
  flex-direction:column;
  gap:.16rem;
  font-size:.8rem;
  cursor:pointer;
  border:1px solid rgba(30,64,175,.55);
  background:rgba(15,23,42,.9);
  color:#e5e7eb;
  transition:border .18s ease, background .18s ease, box-shadow .18s ease;
}
.tv-item-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.tv-item-title{
  font-weight:500;
  max-width:75%;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.tv-item-type{
  font-size:.72rem;
  opacity:.8;
}
.tv-item-desc{
  font-size:.75rem;
  color:var(--muted);
}
.tv-item-title,
.tv-item-type,
.tv-item-desc{
  transition:color .18s ease, opacity .18s ease;
}
.tv-item:not(.active) .tv-item-title,
.tv-item:not(.active) .tv-item-type,
.tv-item:not(.active) .tv-item-desc{
  opacity:.78;
}
.tv-item.active{
  background:radial-gradient(circle at 0 0,rgba(56,189,248,.22),rgba(15,23,42,.96));
  border-color:rgba(56,189,248,.75);
  box-shadow:0 0 0 1px rgba(15,23,42,.4);
}
.tv-item.active .tv-item-title{
  font-weight:600;
  opacity:1;
}
.tv-item:hover{
  border-color:rgba(129,140,248,.9);
}


/* === NOVO CSS PARA O QR CODE === */
#qr-code-tv-container {
  position: absolute;
  top: 2.2rem;
  right: 2.4rem;
  background: #fff;
  padding: 10px;
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0,0,0,.5);
  line-height: 0; /* Para ajustar o QR code perfeitamente */
}

/* RESPONSIVO BÁSICO */
@media (max-width:1000px){
  .tv-wrapper{
    padding:1.6rem 1.8rem;
  }
  .tv-title-block{max-width:100%;}
  .tv-groups{
    grid-template-columns:1fr;
  }
}

/* ==== INÍCIO DA ATUALIZAÇÃO DE RESPONSIVIDADE ==== */
@media (max-width: 600px) {
  .tv-wrapper {
    padding: 1rem; /* Diminui o padding geral */
  }
  .tv-frame {
    padding: 1.5rem 1rem; /* Diminui o padding da "moldura" */
  }
  .tv-header {
    flex-direction: column; /* Empilha o cabeçalho */
    gap: .75rem;
  }
  .tv-title-block {
    max-width: 100%;
  }
  .tv-name { font-size: 1.5rem; }
  .tv-quote { font-size: .9rem; }
  .tv-badge { align-self: flex-start; }

  /* Permite que o texto dos botões da lista quebre a linha */
  .tv-item-title {
    max-width: 100%;
    white-space: normal; /* <-- Correção principal */
    font-size: .85rem;
  }
  .tv-item-desc {
    font-size: .8rem;
  }
  .tv-slide-text {
    font-size: .9rem;
  }
  .tv-slide-meta {
    font-size: .8rem;
  }
  .tv-slide-texto .tv-slide-body {
    padding: 1.5rem 1rem .5rem;
  }
  
  /* Esconde o QR Code em telas muito pequenas */
  #qr-code-tv-container {
    display: none;
  }
}
/* ==== FIM DA ATUALIZAÇÃO DE RESPONSIVIDADE ==== */

</style>
</head>
<body>

<div class="tv-wrapper">
  <div class="tv-frame">
    <header class="tv-header">
      <div class="tv-title-block">
        <div class="tv-label">Mural de homenagens</div>
        <div class="tv-name" id="tvNome">Em memória de Maria Aparecida</div>
        <div class="tv-years" id="tvAnos">1945 – 2025 • “Gratidão em cada gesto.”</div>
        <div class="tv-quote" id="tvFrase">
          “Este mural reúne lembranças, palavras de carinho e momentos que marcaram a história de vida.”
        </div>
      </div>
      <div>
        <span class="tv-badge" id="tvSala">Sala 3 • Velório das 14h às 17h</span>
      </div>
    </header>
    
    <div id="qr-code-tv-container">
      </div>


    <section class="tv-main">

      <div class="tv-carousel">
        <div class="tv-carousel-header">
          <div class="tv-carousel-type" id="tvTipoAtual">Fotos da família</div>
          <div class="tv-carousel-counter" id="tvContador">1 de 5</div>
        </div>

        <div class="tv-media-wrapper">
          <div class="tv-slide active" data-index="0" data-type="foto">
            <div class="tv-slide-media">
              <div class="tv-slide-photo">
                <img src="https://images.pexels.com/photos/3760852/pexels-photo-3760852.jpeg?auto=compress&cs=tinysrgb&w=1200"
                     alt="Foto em família exemplo">
              </div>
            </div>
            <div class="tv-slide-body">
              <div class="tv-slide-text">
                “Momentos simples de almoço em família aos domingos, onde a mesa cheia sempre foi motivo de alegria.”
              </div>
              <div class="tv-slide-meta">
                Enviado por <strong>Ana (filha)</strong> • 2025
              </div>
            </div>
          </div>

          <div class="tv-slide" data-index="1" data-type="foto">
            <div class="tv-slide-media">
              <div class="tv-slide-photo">
                <img src="https://images.pexels.com/photos/4586971/pexels-photo-4586971.jpeg?auto=compress&cs=tinysrgb&w=1200"
                     alt="Foto em viagem exemplo">
              </div>
            </div>
            <div class="tv-slide-body">
              <div class="tv-slide-text">
                “Registro de uma das viagens em família, onde ela fazia questão de tirar foto com cada um separadamente.”
              </div>
              <div class="tv-slide-meta">
                Enviado por <strong>netos</strong>
              </div>
            </div>
          </div>

          <div class="tv-slide tv-slide-texto" data-index="2" data-type="texto">
            <div class="tv-slide-media"></div>
            <div class="tv-slide-body">
              <div class="tv-slide-text">
                “Você nos ensinou que cuidar do outro é a forma mais bonita de amar.
                Obrigado por cada conselho, por cada abraço e por cada oração feita em silêncio.”
              </div>
              <div class="tv-slide-meta">
                Mensagem escrita por <strong>João (filho)</strong>
              </div>
            </div>
          </div>

          <div class="tv-slide" data-index="3" data-type="foto">
            <div class="tv-slide-media">
              <div class="tv-slide-photo">
                <img src="https://images.pexels.com/photos/1307698/pexels-photo-1307698.jpeg?auto=compress&cs=tinysrgb&w=1200"
                     alt="Foto em comemoração exemplo">
              </div>
            </div>
            <div class="tv-slide-body">
              <div class="tv-slide-text">
                “Comemoração dos 70 anos, com toda a família reunida e muitas histórias sendo relembradas.”
              </div>
              <div class="tv-slide-meta">
                Enviado por <strong>família</strong>
              </div>
            </div>
          </div>

          <div class="tv-slide" data-index="4" data-type="video">
            <div class="tv-slide-media">
              <video id="tvVideo" class="tv-video" controls preload="metadata"
                     poster="https://images.pexels.com/photos/7521087/pexels-photo-7521087.jpeg?auto=compress&cs=tinysrgb&w=1200">
                <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
                Seu navegador não suporta vídeo HTML5.
              </video>
            </div>
            <div class="tv-slide-body">
              <div class="tv-slide-text">
                Trecho da comemoração de 70 anos, com toda a família reunida. Um dos dias em que o sorriso
                dela esteve mais presente em todas as fotos.
              </div>
              <div class="tv-slide-meta">
                Vídeo enviado por <strong>netos</strong> • reprodução em tela cheia na TV
              </div>
            </div>
          </div>

          <button class="tv-arrow tv-arrow-left" id="tvPrev" aria-label="Anterior">&#10094;</button>
          <button class="tv-arrow tv-arrow-right" id="tvNext" aria-label="Próximo">&#10095;</button>
        </div>

        <div class="tv-controls">
          <div class="tv-dots" id="tvDots">
            <div class="tv-dot active" data-dot="0"></div>
            <div class="tv-dot" data-dot="1"></div>
            <div class="tv-dot" data-dot="2"></div>
            <div class="tv-dot" data-dot="3"></div>
            <div class="tv-dot" data-dot="4"></div>
          </div>
        </div>
      </div>

      <section class="tv-groups">
        <div class="tv-group-card">
          <div class="tv-group-header">
            <div class="tv-group-title">Fotos do mural</div>
            <div class="tv-group-count">3 fotos</div>
          </div>
          <div class="tv-group-sub">Imagens que poderão ser exibidas na TV do velório.</div>
          <div class="tv-items">
            <button class="tv-item active" data-go="0">
              <div class="tv-item-header">
                <span class="tv-item-title">Foto em família no jardim</span>
                <span class="tv-item-type">Foto</span>
              </div>
              <div class="tv-item-desc">
                Enviada por Ana (filha).
              </div>
            </button>

            <button class="tv-item" data-go="1">
              <div class="tv-item-header">
                <span class="tv-item-title">Viagem em família para a praia</span>
                <span class="tv-item-type">Foto</span>
              </div>
              <div class="tv-item-desc">
                Registro de passeio com filhos e netos.
              </div>
            </button>

            <button class="tv-item" data-go="3">
              <div class="tv-item-header">
                <span class="tv-item-title">Comemoração dos 70 anos</span>
                <span class="tv-item-type">Foto</span>
              </div>
              <div class="tv-item-desc">
                Foto da festa em família.
              </div>
            </button>
          </div>
        </div>

        <div class="tv-group-card">
          <div class="tv-group-header">
            <div class="tv-group-title">Vídeos de homenagens</div>
            <div class="tv-group-count">1 vídeo</div>
          </div>
          <div class="tv-group-sub">Trechos em vídeo selecionados para o mural.</div>
          <div class="tv-items">
            <button class="tv-item" data-go="4">
              <div class="tv-item-header">
                <span class="tv-item-title">Vídeo – Aniversário de 70 anos</span>
                <span class="tv-item-type">Vídeo</span>
              </div>
              <div class="tv-item-desc">
                Vídeo de homenagem exibido na TV.
              </div>
            </button>
          </div>
        </div>

        <div class="tv-group-card">
          <div class="tv-group-header">
            <div class="tv-group-title">Mensagens e textos</div>
            <div class="tv-group-count">1 mensagem</div>
          </div>
          <div class="tv-group-sub">Palavras de carinho, poemas e orações da família.</div>
          <div class="tv-items">
            <button class="tv-item" data-go="2">
              <div class="tv-item-header">
                <span class="tv-item-title">Mensagem dos filhos</span>
                <span class="tv-item-type">Texto</span>
              </div>
              <div class="tv-item-desc">
                Palavra de agradecimento escrita por João.
              </div>
            </button>
          </div>
        </div>
      </section>

    </section>
  </div>
</div>

<script>
// SCRIPT ORIGINAL DO CARROSSEL
(function () {
  const slides = document.querySelectorAll('.tv-slide');
  const dots   = document.querySelectorAll('.tv-dot');
  const items  = document.querySelectorAll('.tv-item');
  const tipoEl = document.getElementById('tvTipoAtual');
  const contEl = document.getElementById('tvContador');
  const prevBtn = document.getElementById('tvPrev');
  const nextBtn = document.getElementById('tvNext');
  const videoEl = document.getElementById('tvVideo');

  if (!slides.length) return;

  let current = 0;
  let prevCurrent = 0;
  const total = slides.length;
  const intervalMs = 9000;
  let autoTimer = null;

  function tipoLabel(type){
    if(type === 'foto')  return 'Fotos da família';
    if(type === 'video') return 'Vídeos de homenagens';
    return 'Mensagens e textos';
  }

  function stopAuto(){
    if(autoTimer){
      clearInterval(autoTimer);
      autoTimer = null;
    }
  }
  function startAuto(){
    stopAuto();
    autoTimer = setInterval(()=>{
      const next = (current + 1) % total;
      showSlide(next);
    }, intervalMs);
  }

  function showSlide(index){
    // se sair do slide de vídeo, pausa e reseta
    if(videoEl && prevCurrent === 4 && index !== 4){
      videoEl.pause();
      videoEl.currentTime = 0;
    }

    slides.forEach((slide,i)=>{
      slide.classList.toggle('active', i===index);
    });
    dots.forEach((d,i)=>{
      d.classList.toggle('active', i===index);
    });
    items.forEach((it)=>{
      it.classList.toggle('active', Number(it.dataset.go) === index);
    });

    const type = slides[index].dataset.type || 'texto';
    tipoEl.textContent = tipoLabel(type);
    contEl.textContent = (index+1)+' de '+total;
    prevCurrent = current;
    current = index;
  }

  dots.forEach((dot,i)=>{
    dot.addEventListener('click', ()=>{
      stopAuto();
      showSlide(i);
      startAuto();
    });
  });
  items.forEach((it)=>{
    it.addEventListener('click', ()=>{
      const idx = Number(it.dataset.go);
      if(!isNaN(idx)){
        stopAuto();
        showSlide(idx);
        startAuto();
      }
    });
  });

  prevBtn.addEventListener('click', ()=>{
    stopAuto();
    const next = (current - 1 + total) % total;
    showSlide(next);
    startAuto();
  });
  nextBtn.addEventListener('click', ()=>{
    stopAuto();
    const next = (current + 1) % total;
    showSlide(next);
    startAuto();
  });

  // Comportamento do vídeo: pausa auto-rotação enquanto toca
  if(videoEl){
    videoEl.addEventListener('play', ()=>{
      stopAuto();
    });
    videoEl.addEventListener('ended', ()=>{
      // espera alguns segundos para a pessoa ler a mensagem
      setTimeout(()=>{ startAuto(); }, 6000);
    });
  }

  startAuto();
})();

// === NOVO SCRIPT PARA CARREGAR DADOS DO MURAL ATIVO ===
(function carregarDadosMural() {
  const muralId = localStorage.getItem('mural_ativo_tv');
  if (!muralId || muralId === 'null') {
    console.log('Nenhum mural ativo encontrado. Usando dados padrão.');
    // Se nenhum mural estiver ativo, esconde o container do QR
    const qrContainer = document.getElementById('qr-code-tv-container');
    if(qrContainer) qrContainer.style.display = 'none';
    return; // Usa os dados estáticos da página
  }
  
  const muraisDB = JSON.parse(localStorage.getItem('muraisDB')) || {};
  const mural = muraisDB[muralId];
  
  if (!mural) {
    console.error('Dados do mural não encontrados:', muralId);
    return;
  }
  
  // Atualiza os textos da tela
  document.getElementById('tvNome').textContent = 'Em memória de ' + mural.nome;
  document.getElementById('tvAnos').textContent = `${mural.nasc || '...'} – ${mural.fal || '...'} • "${mural.frase || '...'}"`;
  
  // Gera o QR Code na tela
  const qrContainer = document.getElementById('qr-code-tv-container');
  // Garante a URL completa
  const urlCompleta = new URL(mural.qrUrl, window.location.origin).href;

  new QRCode(qrContainer, {
      text: urlCompleta,
      width: 90, // Tamanho pequeno para o canto
      height: 90,
      colorDark : "#020617",
      colorLight : "#ffffff",
      correctLevel : QRCode.CorrectLevel.H
  });
  
})();
</script>

</body>
</html>